# Credit Scoring Model (PD Prediction)

Проект по разработке модели кредитного скоринга для оценки вероятности дефолта
(probability of default, PD) на основе исторических данных о заемщиках
(датасет "Give Me Some Credit"). Реализован в виде модульного пайплайна
с фокусом на автоматизацию валидации и бизнес-интерпретацию результатов.

## Цели проекта

- Построение бинарного классификатора для оценки кредитного риска (default / non-default)
- Сравнение базовых и продвинутых моделей:
  - Logistic Regression (baseline)
  - Random Forest
  - Gradient Boosting (CatBoost, LightGBM, XGBoost)
- Оценка качества моделей с использованием:
  - ROC-AUC
  - Gini
- Проверка устойчивости моделей через стратифицированную кросс-валидацию
- Бизнес-интерпретация результатов и выбор порога для принятия решений

## Технологический стек

- **Язык**: python
- **ML-библиотеки**: scikit-learn, catboost, lightgbm, xgboost
- **Анализ данных**: numpy, pandas, matplotlib, seaborn
- **Инструменты**: EDA, feature engineering

## Структура проекта

Проект организован следующим образом:
- `data/` — исходные и обработанные данные;
- `models/` — сохраненные артефакты (модели, параметры и метрики);
- `notebooks/` — jupyter-ноутбуки:
  - `01_eda_and_prep.ipynb` — EDA, очистка и подготовка данных, feature engineering;
  - `02_modeling.ipynb` — обучение, подбор гиперпараметров, интерпретация результатов;
- `src/` — модульные скрипты для препроцессинга, обучения моделей и оценки метрик.

## Результаты моделирования

Проведено сравнение 5 архитектур. Все модели обучались на обучающей выборке с использованием
Stratified K-Fold (5 фолдов) и GridSearchCV. Финальная оценка проводилась на отложенной
тестовой выборке (hold-out set 20%), не участвовавшей в обучении и подборе гиперпараметров.

| Модель              | ROC-AUC |  Gini  | Комментарий               |
|---------------------|:-------:|:------:|---------------------------|
| CatBoost            | 0.8703  | 0.7405 | Лучшая стабильность       |
| LightGBM            | 0.8692  | 0.7384 | Высокая скорость обучения |
| XGBoost             | 0.8688  | 0.7376 | Сопоставим с LightGBM     |
| Random Forest       | 0.8617  | 0.7233 | Склонен к переобучению    |
| Logistic Regression | 0.8335  | 0.6669 | Baseline-модель           |

## Ключевые инсайты

- Выявлена нелинейная зависимость между возрастом (`age`) заемщика и риском дефолта: молодые группы имеют самую высокую вероятность дефолта (PD), а старшие — самую низкую.
- Факторы прошлых просрочек (`Total_Late_Payments`, `NumberOfTime30-59...`) имеют наибольшую предсказательную силу. Коэффициент отношения шансов (odds-ratio) для недавних просрочек превышает 3.6, что делает их критическими стоп-факторами.
- Фактор `RevolvingUtilization...` демонстрирует высокую чувствительность: рост показателя на одно стандартное отклонение увеличивает шансы на дефолт в 2.3 раза.

## Roadmap развития проекта

**Статус проекта: находится в стадии разработки**

Планируемые шаги:
- [x] Интерпретация логистической регрессии (анализ весов и расчет odds-ratio).
- [ ] Оптимизация порога принятия решений (Threshold) на основе баланса Precision/Recall для максимизации прибыли банка.
- [ ] Интерпретация CatBoost с помощью SHAP.
- [ ] WoE-бининг и расчёт IV для скоринговых признаков.

## Как запустить

1. Клонировать репозиторий:
```git clone https://github.com/george-gh5/credit-scoring-ml.git```
2. Установить зависимости:
```pip install -r requirements.txt```
3. Последовательно запустить ноутбуки в папке `notebooks/`